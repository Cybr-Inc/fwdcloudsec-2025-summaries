# Beyond the Big Threeï¼š Mastering Oracle Cloud Security in a Multi-Cloud World

**Video Link**: [Watch on YouTube](https://www.youtube.com/watch?v=L-Y2UKnaLAM)

- **Author**: Danny Kaganovic
- **Talk Type**: Cloud Security

## Summary

This talk provides an overview of Oracle Cloud Infrastructure (OCI) security, contrasting its features and architecture with the "big three" cloud providers (AWS, Azure, GCP). The speaker, Danny Kaganovic, details why customers are moving to OCI (cost, legacy systems) and explains how to leverage its native preventive security tools. The presentation focuses on two practical use cases: enforcing data residency through region restriction and blocking public internet access to sensitive environments using services like Governance Rules, IAM Policies, and Security Zones.

## Key Points

- **Why OCI?**: Customers primarily choose OCI for its competitive infrastructure costs and for migrating existing Oracle database workloads.
- **Simplified Hierarchy**: OCI uses a simple two-level hierarchy: the `tenancy` (the root container, like an AWS Organization) and `compartments` (which function like AWS Accounts or GCP Projects, holding resources).
- **Key Differentiators**: OCI features off-box network virtualization for physical tenant separation, encrypts all data at rest by default, offers highly granular IAM policies, and provides most of its security services free of charge.
- **Preventive Controls**: The talk emphasizes using OCI's native preventive controls, which fall into two categories: Identity (IAM Policies) and Configuration (Governance Rules, Security Zones).
- **IAM Policies**: OCI's IAM is very flexible. While historically based on an `allow` model, `deny` statements are now in limited availability, which will simplify permissions management similar to AWS SCPs.
- **Security Zones**: A powerful, free feature within CloudGuard that allows you to apply pre-defined, non-customizable security policies (e.g., "deny public subnets") to compartments to prevent insecure configurations.
- **Combined Approach**: For comprehensive security, it's recommended to combine different services. For instance, use Security Zones for network controls and Quota Policies to restrict the creation of specific resource types not covered by Security Zones.

## Technical Details

### Architecture Components
- **OCI Hierarchy**:
    - **Tenancy**: The root-level container for all resources, similar to an AWS Organization or GCP Organization.
    - **Compartment**: A logical container for organizing and isolating cloud resources. It is both a container and a resource entity, meaning policies can be attached to it, and it can also hold resources directly. Compartments can be nested.
- **Key OCI Services Mentioned**:
    - **OCI IAM**: Manages access control with policies. The structure is `Allow group <identity> to <verb> <resource-type> in <location> where <conditions>`.
        - Verbs: `inspect`, `read`, `use`, `manage`.
    - **Governance Rules**: A centralized way to enforce policies across tenancies. Used for setting allowed regions, service quotas, and default tags. Requires opting into an OCI "Organization."
    - **Quota Policies**: Used to set limits on the number of resources that can be created. Governance Rules for region restriction work by creating zero-quota policies for all services in disallowed regions.
    - **CloudGuard**: OCI's native CSPM service, which is free to enable.
    - **Security Zones**: A feature within CloudGuard that enforces a "recipe" of preventive policies on a compartment.

### Implementation Steps

**Use Case 1: Region Management (Data Residency)**
- **Goal**: Ensure workloads only run in approved geographic regions.
- **Method 1: Governance Rules (Centralized)**
    1. Opt-in to an OCI Organization.
    2. Create a template defining the list of allowed regions (e.g., `US Ashburn One`).
    3. Apply the governance rule via CLI or console. This creates a quota policy in the background, setting the quota for all resource families to `0` in non-approved regions.
    - **Limitation**: Users may still be able to *create* certain resources (like an Object Storage bucket) but will not be able to *use* them (e.g., upload files).
- **Method 2: IAM Policies (Flexible)**
    1. Add a condition to every IAM policy statement: `where request.region = 'US-Ashburn-1'`.
    - **Limitation**: Prone to configuration drift, as new IAM statements could be created without this condition, accidentally granting cross-region permissions.

**Use Case 2: Block Direct Inbound Internet Access**
- **Goal**: Restrict sensitive environments to internal-only network access.
- **Method: Security Zones**
    1. Enable the free CloudGuard service for the tenancy.
    2. Security Zones provide 76 built-in, non-customizable policies. Select relevant policies, such as:
        - Deny public subnets
        - Deny internet gateways
        - Deny public load balancers
        - Deny public object storage buckets
    3. Create a "recipe" by combining the desired policies.
    4. Attach the recipe to a new or existing compartment. The policies are inherited by all sub-compartments.
    - **Limitations**:
        - Only one Security Zone can be attached per compartment.
        - No native support for exclusions (workaround: detach the zone, create the excluded resource, re-attach the zone).
        - Policies are not customizable.
- **Combined Approach**: To block services not covered by Security Zones (e.g., public DNS zones), create a `zero` Quota Policy for that specific service in the target compartment.

## Full Transcript

All right, hey everybody, how's it going? Welcome back from lunch. If you wanna grab some seats, we've got our next talk coming up here, which is going to be Beyond the Big Three, mastering Oracle Cloud Security in a multi-cloud world. And before we get started, just want to give a thanks to one of our sponsors here for this talk, a Silver Sponsor, Sonray Security. If you wanna check out more information about them, they're out, you can see their booth out there outside of the conference room. And then for any questions that you might have for the speaker after the talk, we'll hold those till the end and then I'll bring the microphone around and you can ask your questions. And please, without further ado, welcome Danny Kaganovic for the Beyond the Big Three, mastering Oracle Cloud Security in a multi-cloud world. (audience applauding) - Hi, nice being here today. This is my first time as conference, attending and speaking. And actually it's my first time speaking in the States and honestly in English after I completed some achievements in Duolingo. No, not really. So, (laughs) so my name is Danny Kaganovic, I'm a product manager at Rocksteady, a native by Rocksteady. And welcome to the Beyond the Big Three, mastering Oracle Cloud Security in a multi-cloud world, in a multi-cloud world, okay? This is important. And a little bit about Rocksteady, where cloud security startup, we're dedicated creating secure by design, cloud environments. And we're doing this by leveraging native capabilities that are provided by the cloud providers. We decided to leverage this native capabilities because the providers provide the preventive mechanisms, the policies and all these set of tools, free of charge, most of them. And they're built in and integrated into the provider services. And for the years as I worked for major providers like Google Cloud and Oracle, I've seen that these capabilities are not well utilized by customers. Okay, they have very strong guardrails, but customers won't use them good enough to set the guardrails very well for their environment. It's a bit scary for some customers to set very strong guardrails, but the second reason is the knowledge, okay? Not everyone knows how to do it. So we found the edge in these services that the cloud providers provide them, and the development of them happening, as we speak, as now we're in touch with them. And here, it's very important in OCI. OCI is an integral part of our multi-cloud portfolio that we offer, because we hear more and more from customers that they are migrating or using OCI, and OCI, they don't know well how to set these guardrails in OCI. So in this presentation, we'll focus, we'll explore this topic. Specifically, we'll compare OCI to other providers, the tools that they provide. We're going to talk about why customers choose OCI, and two things you need to know about the cloud structure, because it's important, and some key differences between OCI and other providers. And I'll walk you through two use cases, two manual cases of preventive security that will demonstrate how to use these capabilities. So starting from OCI, so we speak with 4,100 customers, and recently we noticed that there was increasing demand in OCI, like more and more customers are migrating, using OCI, and asking us to support OCI. So there are two main reasons from my experience why customers choose OCI. So first of all, it's like legacy Oracle customers, they already used Oracle products. And the second thing is cost. It's really hard to compete against Oracle when we talk about infrastructure costs. So this is one of the main reasons customer today, Phenops is very wide important today in the last few years, so this is one of the main reasons why they choose them. So before we get into the details, just I need to know about the cloud structure. So when we compare the cloud structure of each provider, we have a few levels in the structure. For example, some of you may use AWS, so you know you have the top level, you have the organizations, and then you have the OU, the accounts, and in Azure you have the tenant, then the management group, the subscription, the resource groups, and GCP organization, and folder project. In OCI you just have two entities, which you need to know. The first one is tenancy, it's similar to organization, this is the first entity when you create the environment. And the second thing is the compartment. Now a key difference here between OCI and other providers that the compartment is both a container, like a second level container, and it's a resource entity. So you can create resources in the compartment, like you create them in the account, in the resource group, and in the project. So this is very important because I'll show you the inheritance and why it's matter. So if we look a bit deeper into the compartments, the first, when we create a tenancy, when the tenancy is created, it's created with the root compartment. The root compartment is the main compartment every organization has, and what's important about the root compartment, it's always the top level, and you can use only, you can use some of the services only in the root compartment. So these services are the preventive services that I will show you a bit later, and some more security services, and you can still create resources as you create resources in other compartments in the root compartment. A few differences between OCI and others. So I took four of them. The first one I think is one of the strongest. OCI has built its own data centers. They use their own hardware, and when they build the data centers and the hypervisors, they did an off-box visualization. They separated the network physically between each customer. So each customer enjoys his own network. It's not shared, it's on the NIC level, and I don't think that the other providers do that today. The second thing is that everything is, every data store in OCI is encrypted address by default. Okay, so you don't need to do any settings like in other cloud providers to look which data stores you use and to set the encryption. It comes out of the box as default address, encrypted address. The third thing is granular IAM. So I tested this a few weeks ago with a load of different conditions when I put in a single IAM statement, and I didn't find any limitation, at least as I know. So it's very granular, very flexible, and it supports a lot of conditions that you can set per each statement. And the fourth thing is that while OCI doesn't have that much security services in OCI, compared to others, most of them are free of charge, like they come free of charge out of the box. When some of them you can enable them, some of them you don't need to enable them, and the ones that are not free of charge, they're very cheap compared to others. So this is the differentiators between OCI and other providers. Keeping that in mind, now I'm going to show you two categories of preventive services in OCI. First of all, we're looking on identity level. So from the identity perspective, as you know, who can do what and where, classic IAM. So this is one thing we're going to use. And from a configuration standpoint, so we look on the environment level, we can set governance rules. Governance rules are how I want to see my environment, like how it should be configured. It's similar to Azure. Azure has a service, Blueprints, or GCP-assured workloads, if we compare it. And there's another powerful service called Security Zones, which I will show you. Now, a little bit about IAM policies, the structure. I changed the slide, I didn't change the slide a few hours ago, I just got an update from OCI. They have a limited availability, they started to support as of recently, of deny statements. It wasn't here, and I thought how I'm going to share this with you, but now, it should be really easier to manage the IAM statements with a deny statement, and it will be a bit similar to SCP from AWS. So the structure is very simple in OCI, allow certain identity, a group, or a service to a verb. We have read, we have inspect, use, and manage, so we can get, list, use, and administer resource. Resource is a resource family or all resources, in a certain scope. Scope is a compartment or a tendency level, and the optional part is the work conditions. Now, one thing to mention here, is that if you said a permission, I know that you have some issues reading it, so I'll read it. So I said the statement, allow group network admins to manage virtual network family, to manage virtual networks, in a compartment prod. So this is a statement I said on a prod compartment, which is a sub compartment, and once I said, with allow, allow any group to manage virtual network in tenancy, it will be inherited, and it will, and this condition, this other statement, will not be relevant, because I overrided with the implicit allow, so what's changed is that they're going to support finally the deny, and you won't have this issue if you will use proper deny statements. Next thing you can use, is a more centralized way to manage your organization, is governance rules. This requires one action to do before you actually use it, you need to opt into an organization, it's something that manage multiple tenancies, it's a logical entity outside of the tenancy, so just to keep that in mind, I do encourage you to do this, because governance rules are also powerful, and we have currently three actions you can do with governance rules, you can set allowed regions, like to opt in regions or to restrict regions, you can do quota policies for services, and the third part, you can set default tags for the environment. Now, I'm going to go over the first use case, and this is a very common use case, very powerful use case, we usually demonstrated as Rocksteady, region management, so I have a simple intent, like imagine a CISO asks, I want to ensure that all cloud workloads stay within the approved regions only, okay? So this is the requirement, and behind this, the business objective is, like for example, data residency, I want to keep user data like Europe, GDPR requirements only in Europe, or the second one can be to reduce the attack surface, you know, crypto mining usually, they go into regions which are not popular, or not monitored, and they create this crypto mining virtual machines, and the third one is to reduce monitoring requirements for regions that I don't use, so this very simple use case covers a lot of security aspects, now if we translate this to technical terms in OCI, one, I can restrict opt-in regions because Oracle supports a model of subscribing to new regions, and second thing, I want to use only approved regions, so how are we going to implement that? One, we're studying with the governance rules, it's a very simple template, I used CLI commands to demonstrate this, so first of all, we're creating a list of the allowed regions only, here I used US Ashburn One in OCI, and there's the long command that takes the template, applies the governance rules, and now this is what's supported, if I translate this to what really happens in OCI behind the scenes, the governance rules create a quota policy for these regions, okay? It sets actually quota policy, if you look into the details, there's a limitation and problem with this, because if you do a quota policy in OCI, for certain reason, users can still create some resources, like for example, object storage, but they will not be able to use it, they will not be able to upload files to the object storage, so if you're very sensitive to the reports you see, I would recommend using something else that we'll show you in a moment, but just keep that in mind, now it looks like this, there's a list of all the resource families, so you set zero quotas for all the resource families, and then you unset for the excluded regions, so you can do it with a quota policy without using governance rules by yourself, the only difference with governance rules is that it adds some kind of a lock when you do it, so this is the difference between using a raw quota policy compared to governance rules OCI provides. The second method of applying regions, and I didn't have time, but I will show you how to do it with allow, so imagine you're doing this with deny, is to set conditions, this is a more flexible way to do it, but it less centrally managed, so you add a condition to each IM statement, where you say request region, US-Azurn one, and you do it for all the statements, now one of the problem with the IM implicit allow statements is that as I mentioned before, when you add a new condition, and when you add a new statement and you do not have a condition, it creates some kind of a, we call it drift, and you need to manage it, you need to add the conditions to the new statements created, so it's very important to track that if you choose this method. So to sum this up, so best practice is if you want centralized management, OCI, like we recommend using governance rules or quota policies, which you prefer, the alternative is to use the IM policies with the conditions, and the limitations, as I mentioned, is that you can seal provisional services with the quota policies, the governance rules, and with the IM policies, someone can override your existing statements. Moving to the second use case, which is very interesting, and it's a use case that we were requested to support in a multi-cloud for some of our customers, is to block direct inbound access, so imagine this simple intent, I want to restrict sensitive environments to internal only network, I want to block public internet access to this compartments, okay? So here, the business objective behind this is I have a sensitive data, which should not be shared, should not be internet accessible, and I want to block it, so in technical terms, I'm translating this to how we implement this in OCI, we have two things, one, we have a virtual network, a VCN in OCI, which will need to prevent the access to block it, and we have the more challenging part, is the managed services, because some of the managed services that you provision can communicate with some services in the virtual network, so the goal is to block both of them. So how to do it? And here comes a very powerful tool called security zones, now security zones is a part of a service called CloudGuard in OCI, I don't really know why it's part of CloudGuard, but it is, and you need to enable CloudGuard, it's free of charge, it doesn't cost, I do encourage you to do this, CloudGuard is the CSPM service for OCI, and once you enable it, you can enjoy security zones, now the powerful thing about security zones is that it has built-in policies, okay? You have like 76 built-in policies, last month they added some more policies, now it's 76, and each policy transit to something very simple, like deny public subnets, okay, I want to deny public subnets, I want to deny internet getaway, I want to deny public load balancer, and these are the virtual network attached parts that I want to deny, so once I have these ideas, I'm doing this with the CLI, I take all the policy that I'm interested in, and I create a recipe, and this recipe, I attach it to some entity, remember we still have this inheritance, so the entity that I attach it, it will be inherited downwards, so it's important, now this part covers very simply the virtual network, we can compare it to declarative because of its simplicity, declarative policies in Amazon for blocking network, and if I want to add managed services, currently here I have one example for public buckets, I add another policy for denying public buckets, and I update the existing recipe, the existing recipe I created before, and now I support public buckets and virtual networks, now they don't support all the managed services, here is the limitation, and my recommendation is to use a combination of different services that I mentioned to get the goal that you want to block the managed services, so here for example we use security zones, now if you want for example to block a public DNS zones, you don't want a public DNS zones to be created, I encourage you to set a quota policy to zero for public DNS zones in OCI in combination with security zones, and that's how you can limit more services in OCI, more managed services in OCI in addition to the virtual network services, a few limitations, a few things that you need to remember that the security zones I do recommend to create them for new environments, you can create them for existing environments, but I recommend to like to do a first start, some limitations, it's only one security zone per compartment once it's attached, and it has no native support for exclusion, so if you want to exclude something like CIDR blocks or something like that, you won't be able to do it, you can attach the security zone, detach it, put some new services and then attach it again and that's how you can do the work around for the exclusions, and the policies, the 76 policies I mentioned, they're built in, they're not customizable, so this is another key limitation, I hope they will add more policies as we speak, so thanks for your time, I hope you learned something new here in this presentation, you're welcome to ask me questions now and to encourage you to visit our booth, we see it near track one, we can show you some demo and some support for OCI and other providers you work with, so thank you very much, I enjoyed the session. (audience applauding) - Thanks Danny, any questions in the room here for Danny, I can bring the microphone around. Okay, we'll go closest to further away. - Cool, could you go back one slide real quick, so you were talking about one security zone per compartment but you can have multiple layers of nested compartments, so can you have like a zone on the root compartment, a zone on the folder level compartment and then a zone on the final compartment, or is it just one zone? - Just one. - Just one, so if you put it on the root, doesn't matter, you've done it for the entire tenancy. - Yeah, we do, if you need different requirements, I do recommend attaching different zones to different compartments. - One of the challenges we've been facing is how you actually get a picture of, for a given identity, given resource, who has access to it, because of the way the policies are written, have you done anything around solving that challenge? - Who have access, yeah that's a good-- - So like if you've got multiple policies, right, that apply to a user, you can't centrally see these are the five policies that apply. - Yeah, we have this sort of visibility in our system, but in addition to the limited availability that they added today, as I said for the next statements, I also received a message that there's some kind of a simulator, which is a new one, so we'll test it and definitely share something about it. - Awesome, thank you. - Any other questions? Nope, all right. Well, let's give another round of applause for Danny, we appreciate the talk here today. 
(audience applauding)